<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In - Auron</title>

    <!-- Plus Jakarta Sans (Neural Music brand) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Logto Browser SDK via ES Module -->
    <script type="module">
        import LogtoClient from 'https://esm.run/@logto/browser';

        // Make LogtoClient available globally
        window.LogtoClient = LogtoClient;

        // Initialize Logto with your config
        window.logtoConfig = {
            endpoint: 'https://auth.neuralsyndicate.com/',
            appId: 'a5m87e4osv2y7vv8asbwu',
        };

        console.log('✓ Logto SDK loaded successfully');
    </script>

    <script src="logto-config.js?v=2"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#000DFF',
                        'primary-dark': '#001AFF',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background: #000000;
            background-image:
                radial-gradient(at 20% 30%, rgba(0, 13, 255, 0.05) 0px, transparent 50%),
                radial-gradient(at 80% 70%, rgba(0, 13, 255, 0.05) 0px, transparent 50%);
        }

        .glow-border {
            box-shadow: 0 0 20px rgba(0, 13, 255, 0.2);
        }

        .password-toggle {
            cursor: pointer;
            user-select: none;
        }

        html { scroll-behavior: smooth; }

        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        /* Sci-Fi Shimmer Effects */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes shimmer {
            0%, 100% { background-position: -200% center; }
            50% { background-position: 200% center; }
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Sci-fi button with animated gradient + VISIBLE shimmer */
        .btn-sci-fi {
            position: relative;
            background: linear-gradient(135deg, #000DFF 0%, #001AFF 50%, #000DFF 100%);
            background-size: 200% 200%;
            animation: gradient-shift 3s ease infinite;
            transition: all 0.3s ease-out;
            overflow: hidden;
        }

        .btn-sci-fi:hover {
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 0 40px rgba(0, 13, 255, 0.6), 0 0 80px rgba(0, 13, 255, 0.4);
        }

        .btn-sci-fi::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 20%, rgba(255, 255, 255, 0.6) 50%, transparent 80%);
            animation: shimmer 2s linear infinite;
            z-index: 1;
        }

        .btn-sci-fi > * {
            position: relative;
            z-index: 2;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function LoginPage() {
            const [loading, setLoading] = useState(false);
            const [checking, setChecking] = useState(true);

            // Check if already authenticated
            useEffect(() => {
                async function checkAuth() {
                    try {
                        const isAuth = await window.LogtoAuth.isAuthenticated();
                        if (isAuth) {
                            console.log('Already authenticated - redirecting to dashboard...');
                            window.location.href = 'dashboard.html';
                            return;
                        }
                    } catch (err) {
                        console.error('Auth check failed:', err);
                    } finally {
                        setChecking(false);
                    }
                }
                checkAuth();
            }, []);

            const handleSignIn = async () => {
                setLoading(true);
                try {
                    console.log('Initiating Logto sign-in...');
                    await window.LogtoAuth.signIn();
                    // User will be redirected to Logto
                } catch (err) {
                    console.error('Sign-in failed:', err);
                    alert('Failed to initiate sign-in. Please try again.');
                    setLoading(false);
                }
            };

            if (checking) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <div className="text-gray-400">Checking authentication...</div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen flex items-center justify-center p-8">
                    <div className="w-full max-w-md">
                        <a href="index.html" className="text-gray-400 hover:text-primary transition-colors mb-8 inline-block">
                            ← Back to Home
                        </a>

                        <div className="rounded-2xl border border-gray-800 p-10 glow-border"
                             style={{ background: 'rgba(15, 15, 20, 0.9)' }}>

                            <h1 className="text-4xl font-bold mb-2"
                                style={{
                                    background: 'linear-gradient(135deg, #000DFF 0%, #001AFF 100%)',
                                    WebkitBackgroundClip: 'text',
                                    WebkitTextFillColor: 'transparent',
                                    backgroundClip: 'text'
                                }}>
                                Welcome Back
                            </h1>
                            <p className="text-gray-400 mb-8">Continue your sonic journey with Auron</p>

                            <button
                                onClick={handleSignIn}
                                disabled={loading}
                                className="w-full py-4 rounded-lg text-white font-semibold text-lg btn-sci-fi transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                                {loading ? 'Redirecting to Sign In...' : 'Sign In with Logto'}
                            </button>

                            <div className="mt-6 text-center text-sm text-gray-500">
                                <p>Secure authentication powered by Logto</p>
                                <p className="mt-2">You'll be redirected to auth.neuralsyndicate.com</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<LoginPage />, document.getElementById('root'));
    </script>
</body>
</html>
